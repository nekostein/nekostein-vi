% Ver 2024-04-20T20:15:31+00:00
\documentclass[a4paper,11pt]{article}
\usepackage[textwidth=31em,rmargin=25mm,tmargin=90mm,bmargin=37mm]{geometry}
\newcommand{\calculatedlogowidth}[0]{210mm-50mm-31em-1mm}
\usepackage{calc,fontspec,tabularx,longtable,tabu,booktabs,xcolor,datetime2,paralist,enumitem,hyphenat,graphicx,eso-pic}
\usepackage{adjustbox}
\usepackage[hidelinks]{hyperref}
\usepackage{xeCJK,xeCJKfntef}
\xeCJKsetup{PunctStyle=plain,RubberPunctSkip=false,AllowBreakBetweenPuncts=true,LoadFandol=false,WidowPenalty=1000,CJKglue=\strut\hskip 0pt,CJKecglue=\strut\hskip 0.35em plus 5em minus 0.09em}
\setmainfont{NewComputerModern10}
\setromanfont{NewComputerModern10}
\setsansfont{Roboto}
\setmonofont{JetBrains Mono NL}
\setCJKmainfont[AutoFakeSlant]{Noto Serif CJK SC}
\setCJKromanfont[AutoFakeSlant]{Noto Serif CJK SC}
\setCJKsansfont[AutoFakeSlant,BoldFont={Noto Sans CJK SC Bold}]{Noto Sans CJK SC}
\setCJKmonofont[AutoFakeSlant,BoldFont={Noto Sans CJK SC Bold}]{Noto Sans CJK SC}
\pagestyle{empty}

\setdefaultleftmargin{2em}{2em}{2em}{2em}{2em}{2em}

\setlength{\parindent}{0pt}
\setlength{\parskip}{5pt}
\linespread{1.05}
\setlength{\tabulinesep}{3.5pt}
\frenchspacing

\usepackage{sectsty}
\allsectionsfont{\sffamily\raggedright}




\newlength{\sendtoareaextraraise}
\setlength{\sendtoareaextraraise}{-4pt}
\newcommand{\sendto}[1]{
	\AddToShipoutPictureFG*{
		\put(25mm,0mm){%
			\noindent\begin{minipage}[b][207mm+\sendtoareaextraraise][t]{43mm}%
				\footnotesize\sffamily\noindent#1%
			\end{minipage}%
		}%
	}
}


\newcommand{\tabukvlist}[2]{%
	\begingroup%
	\tabulinesep=0.5pt%
	\tabcolsep=8pt%
	#1%
	\hspace{-\tabcolsep}\begin{tabu}{ll}
		#2
	\end{tabu}%
	\endgroup%
}

\newcommand{\lettertitle}[1]{
	\toparea{%
        \raggedright%
		\vfill%
		\sffamily\LARGE\bfseries\upshape%
		\strut#1%
	}
}
\newcommand{\emailheading}[1]{
	\toparea{
		\vfill\tabcolsep=0pt
		\small\sffamily\mdseries
        \tabukvlist{}{#1}
		\hrule
	}
}
\newcommand{\toparea}[1]{
	\AddToShipoutPictureFG*{
		\put(\paperwidth-\textwidth-25mm,307mm){%
			\begin{minipage}[t][90mm][t]{\textwidth}%
				\vfill#1
			\end{minipage}
		}
	}
}

\newcommand{\letterhello}[1]{\noindent#1\par\vskip 1em}

\newcommand{\lettersigwidth}[0]{\linewidth}
\newcommand{\lettersig}[1]{
	\vfill
	\noindent\parbox{\lettersigwidth}{#1}
	\vskip 1em
}


\newcommand{\footercontentleft}[0]{NEKOSTEIN HQ}
\newcommand{\footercontentright}[0]{\thepage}
% NEKO AND KUMA ARE FRIENDS FOREVER



\newcommand{\setupfooters}[2]{%
    \renewcommand{\footercontentleft}[0]{##1}%
    \renewcommand{\footercontentright}[0]{##2}%
}
\newcommand{\setupdecorations}[0]{
	\AddToShipoutPictureBG{
		\put(25mm,265mm){%
			\noindent%
			\normalsize
			\includegraphics[width=\calculatedlogowidth]{_dist/libvi/logocomb/Nekostein-logocombH.black.png}
		}
		\put(25mm,18mm){%
			\parbox{\paperwidth-50mm}{%
				\noindent%
				\adjustbox{width=\linewidth,height=0.5pt}{%
					\noindent%
					\rule{9pt}{1pt}~\rule{4pt}{1pt}~~~\rule{4pt}{1pt}~~~\rule{9pt}{1pt}~\rule{4pt}{1pt}~\rule{9pt}{1pt}~~~\rule{9pt}{1pt}~\rule{9pt}{1pt}~\rule{9pt}{1pt}~~~\rule{4pt}{1pt}~\rule{9pt}{1pt}~~~\rule{9pt}{1pt}~\rule{4pt}{1pt}~~~\rule{9pt}{1pt}~\rule{4pt}{1pt}~\rule{4pt}{1pt}~~~\rule{9pt}{1pt}~\rule{4pt}{1pt}~\rule{9pt}{1pt}~~~\rule{4pt}{1pt}~\rule{4pt}{1pt}~\rule{9pt}{1pt}~~~\rule{9pt}{1pt}~\rule{9pt}{1pt}~~~\rule{4pt}{1pt}~\rule{9pt}{1pt}~~~\rule{4pt}{1pt}~\rule{9pt}{1pt}~~~\rule{4pt}{1pt}~\rule{9pt}{1pt}~\rule{4pt}{1pt}~~~\rule{4pt}{1pt}~~~\rule{4pt}{1pt}~\rule{4pt}{1pt}~\rule{9pt}{1pt}~\rule{4pt}{1pt}~~~\rule{4pt}{1pt}~\rule{9pt}{1pt}~\rule{4pt}{1pt}~~~\rule{4pt}{1pt}~\rule{4pt}{1pt}~~~\rule{4pt}{1pt}~~~\rule{9pt}{1pt}~\rule{4pt}{1pt}~~~\rule{9pt}{1pt}~\rule{4pt}{1pt}~\rule{4pt}{1pt}~~~\rule{4pt}{1pt}~\rule{4pt}{1pt}~\rule{4pt}{1pt}~~~\rule{4pt}{1pt}~\rule{4pt}{1pt}~\rule{9pt}{1pt}~\rule{4pt}{1pt}~~~\rule{9pt}{1pt}~\rule{9pt}{1pt}~\rule{9pt}{1pt}~~~\rule{4pt}{1pt}~\rule{9pt}{1pt}~\rule{4pt}{1pt}~~~\rule{4pt}{1pt}~~~\rule{4pt}{1pt}~\rule{4pt}{1pt}~\rule{4pt}{1pt}~\rule{9pt}{1pt}~~~\rule{4pt}{1pt}~~~\rule{4pt}{1pt}~\rule{9pt}{1pt}~\rule{4pt}{1pt}%
				}%
			}
		}
		\put(25mm,23mm){%
			\parbox{\paperwidth-50mm}{%
				\small%
				\rmfamily\noindent%
				\strut%
				\footercontentleft%
				\hfill%
				\footercontentright%
			}
		}
	}
}

% =================================================
% Extra utils
% =================================================
\newcommand{\enableCjkIndenting}[0]{\setlength{\parindent}{2em}}
\newcommand{\enableFoldingHints}[0]{
	\AddToShipoutPictureFG{
		\put(203mm,95mm){\rule{2mm}{0.4pt}}
		\put(203mm,190mm){\rule{2mm}{0.4pt}}
	}
}
\newcommand{\CJKsloppy}[0]{
	\xeCJKsetup{PunctStyle=plain,RubberPunctSkip=false,CJKglue=\hskip 0pt plus 0.2pt minus 0.1pt,CJKecglue=\hskip 0.35em plus 0.3em minus 0.05em}
}
